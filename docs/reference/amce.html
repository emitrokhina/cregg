<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Tidy estimation of AMCEs — amce • cregg</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Tidy estimation of AMCEs — amce" />

<meta property="og:description" content="Estimate AMCEs for a conjoint analysis and return a tidy data frame of results" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cregg</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Introduction.html">Introduction to cregg</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/leeper/cregg">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Tidy estimation of AMCEs</h1>
    <small class="dont-index">Source: <a href='https://github.com/leeper/cregg/blob/master/R/amce.R'><code>R/amce.R</code></a></small>
    <div class="hidden name"><code>amce.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Estimate AMCEs for a conjoint analysis and return a tidy data frame of results</p>
    
    </div>

    <pre class="usage"><span class='fu'>amce</span>(<span class='no'>data</span>, <span class='no'>formula</span>, <span class='kw'>id</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>feature_order</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>feature_labels</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>level_order</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"ascending"</span>, <span class='st'>"descending"</span>),
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='no'>...</span>)

<span class='fu'>amce_by_reference</span>(<span class='no'>data</span>, <span class='no'>formula</span>, <span class='no'>variable</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A data frame containing variables specified in <code>formula</code>. All RHS variables should be factors; the base level for each will be used in estimation and its reported AMCE will be NA (for printing).</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>A formula specifying an AMCE model to be estimated. All variables should be factors.</p></td>
    </tr>
    <tr>
      <th>id</th>
      <td><p>An RHS formula specifying a variable holding respondent identifiers, to be used for clustering standard errors.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>An (optional) RHS formula specifying a variable holding survey weights.</p></td>
    </tr>
    <tr>
      <th>feature_order</th>
      <td><p>An (optional) character vector specifying the names of feature (RHS) variables in the order they should be encoded in the resulting data frame.</p></td>
    </tr>
    <tr>
      <th>feature_labels</th>
      <td><p>A named list of &#8220;fancy&#8221; feature labels to be used in output. By default, the function looks for a &#8220;label&#8221; attribute on each variable in <code>formula</code> and uses that for pretty printing. This argument overrides those attributes or otherwise provides fancy labels for this purpose. This should be a list with names equal to variables on the righthand side of <code>formula</code> and character string values; arguments passed here override variable attributes.</p></td>
    </tr>
    <tr>
      <th>level_order</th>
      <td><p>A character string specifying levels (within each feature) should be ordered increasing or decreasing in the final output. This is mostly only consequential for plotting via <code><a href='plot.cj_amce.html'>plot.cj_mm</a></code>, etc.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>A numeric value indicating the significance level at which to calculate confidence intervals for the MMs (by default 0.95, meaning 95-percent CIs are returned).</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>For <code>amce</code>: additional arguments to <code><a href='http://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></code> or <code><a href='http://www.rdocumentation.org/packages/survey/topics/svyglm'>svyglm</a></code>, the latter being used if <code>weights</code> is non-NULL. For <code>amce_by_reference</code>: additional arguments passed to <code>amce</code>.</p></td>
    </tr>
    <tr>
      <th>variable</th>
      <td><p>An RHS formula containing a single factor variable from <code>formula</code>. This will be used by <code>amce_by_reference</code> to estimate AMCEs relative to each possible factor level as a reference category. If more than one RHS variables are specified, the first will be used.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>amce</code> provides estimates of AMCEs (or rather, average marginal effects for each feature level). It does not calculate AMCEs for constrained conjoint designs. The function can also be used for balance testing by specifying a covariate rather outcome on the left-hand side of <code>formula</code>. See examples.</p>
<p><code>amce_by_reference</code> provides a tool for quick sensitivity analysis. AMCEs are defined relative to an arbitrary reference category (i.e., feature level). This function will loop over all feature levels (for a specified feature) to show how interpretation will be affected by choice of reference category. The resulting data frame will be a stacked result from <code>amce</code>, containing an additional <code>.reference</code> column specifying which level of <code>variable</code> was used as the reference category.</p>
<p>Users may desire to specify a <code>family</code> argument via <code>&#8230;</code>, which should be a &#8220;family&#8221; object such as <code><a href='http://www.rdocumentation.org/packages/stats/topics/family'>gaussian</a></code>. Sensible alternatives are <code><a href='http://www.rdocumentation.org/packages/stats/topics/family'>binomial</a></code> (for binary outcomes) and <code><a href='http://www.rdocumentation.org/packages/stats/topics/family'>quasibinomial</a></code> (for weighted survey data).</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='plot.cj_amce.html'>plot.cj_amce</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>data</span>(<span class='no'>hainmueller</span>)
<span class='co'># estimating AMCEs</span>
<span class='fu'>amce</span>(<span class='no'>hainmueller</span>, <span class='no'>ChosenImmigrant</span> ~ <span class='no'>Gender</span> + <span class='no'>Education</span> + <span class='no'>LanguageSkills</span>,
     <span class='kw'>id</span> <span class='kw'>=</span> ~ <span class='no'>CaseID</span>, <span class='kw'>feature_order</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"LanguageSkills"</span>, <span class='st'>"Gender"</span>, <span class='st'>"Education"</span>))</div><div class='output co'>#&gt;            outcome                feature                    level    estimate
#&gt; 1  ChosenImmigrant        Language Skills           Fluent English  0.00000000
#&gt; 2  ChosenImmigrant        Language Skills           Broken English -0.05933832
#&gt; 3  ChosenImmigrant        Language Skills Tried English but Unable -0.12746827
#&gt; 4  ChosenImmigrant        Language Skills         Used Interpreter -0.16199396
#&gt; 5  ChosenImmigrant                 Gender                   Female  0.00000000
#&gt; 6  ChosenImmigrant                 Gender                     Male -0.02726620
#&gt; 7  ChosenImmigrant Educational Attainment                No Formal  0.00000000
#&gt; 8  ChosenImmigrant Educational Attainment                4th Grade  0.03139746
#&gt; 9  ChosenImmigrant Educational Attainment                8th Grade  0.05694292
#&gt; 10 ChosenImmigrant Educational Attainment              High School  0.11825338
#&gt; 11 ChosenImmigrant Educational Attainment         Two-Year College  0.17622493
#&gt; 12 ChosenImmigrant Educational Attainment           College Degree  0.19676219
#&gt; 13 ChosenImmigrant Educational Attainment          Graduate Degree  0.19290717
#&gt;      std.error          z            p        lower       upper
#&gt; 1           NA         NA           NA           NA          NA
#&gt; 2  0.011803743  -5.027076 4.980141e-07 -0.082473226 -0.03620341
#&gt; 3  0.011855107 -10.752182 5.787623e-27 -0.150703848 -0.10423268
#&gt; 4  0.011996863 -13.503027 1.500807e-41 -0.185507378 -0.13848054
#&gt; 5           NA         NA           NA           NA          NA
#&gt; 6  0.008355089  -3.263424 1.100748e-03 -0.043641869 -0.01089052
#&gt; 7           NA         NA           NA           NA          NA
#&gt; 8  0.015401407   2.038610 4.148899e-02  0.001211256  0.06158366
#&gt; 9  0.015430629   3.690253 2.240315e-04  0.026699440  0.08718639
#&gt; 10 0.015606298   7.577285 3.528603e-14  0.087665593  0.14884116
#&gt; 11 0.015604750  11.293032 1.420507e-29  0.145640187  0.20680968
#&gt; 12 0.015948173  12.337600 5.682440e-35  0.165504342  0.22802003
#&gt; 13 0.015744658  12.252230 1.634391e-34  0.162048209  0.22376613</div><div class='input'>
</div># NOT RUN {
# balance testing example
plot(amce(hainmueller[!is.na(hainmueller$ethnocentrism),
     ethnocentrism ~ Gender + Education + LanguageSkills, id = ~ CaseID))

# reference category sensitivity
x <- amce_by_reference(hainmueller, ChosenImmigrant ~ LanguageSkills + Education, 
       variable = ~ LanguageSkills, id = ~ CaseID)
plot(x, group = ".reference")
# }
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Thomas J. Leeper.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

