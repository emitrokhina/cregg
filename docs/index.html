<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simple Conjoint Analysis, Tidying, and Visualization • cregg</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><meta property="og:title" content="Simple Conjoint Analysis, Tidying, and Visualization">
<meta property="og:description" content="Provides simple analyses of conjoint (factorial) experiments and visualization of average marginal component effects ('AMCEs') and marginal means ('MMs') for weighted and unweighted survey data.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">cregg</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Introduction.html">Introduction to cregg</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/leeper/cregg">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">
<div id="simple-conjoint-analyses-and-visualization" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#simple-conjoint-analyses-and-visualization" class="anchor"></a>Simple Conjoint Analyses and Visualization</h1></div>
<p><strong>cregg</strong> is a package for analyzing and visualizing the results of conjoint (“cj”) factorial experiments. It provides functionality that is useful for analyzing and otherwise examining conjoint experimental data:</p>
<ul>
<li>Estimation of average marginal component effects (AMCEs) for fully randomized conjoint designs and munging of AMCE estimates into tidy data frames, via <code><a href="reference/amce.html">amce()</a></code>
</li>
<li>Calculation of marginal means (MMs) for conjoint designs and munging them into tidy data frames via <code><a href="reference/mm.html">mm()</a></code>
</li>
<li>Tabulation of display frequencies of feature attributes via <code><a href="reference/freqs.html">freqs()</a></code> and cross-tabulation of feature restrictions using <code><a href="reference/freqs.html">props()</a></code>
</li>
<li>
<strong>ggplot2</strong>-based visualizations of AMCEs and MMs, via <code>plot()</code> methods for all of the above</li>
</ul>
<p>The package takes its name from the surname of a famous White House Press Secretary.</p>
<p>The main selling point of cregg is simplicity of implementation and - unlike the <a href="https://cran.r-project.org/package=cjoint">cjoint</a> package - cregg tries to follow tidy data principles throughout and provides a formula-based interface that meshes well with the underlying <a href="https://cran.r-project.org/package=survey"><strong>survey</strong></a>-based effect estimation API. Thus the response from any function is a tidy data frame that can easily be stacked with others (e.g., for computing AMCEs for subsets of respondents and then producing a facetted or grouped visualization). It also tries to take better advantage of data preprocessing steps by:</p>
<ul>
<li>Using factor base levels rather than trying to set baseline levels atomically</li>
<li>Using “label” attributes on variables to provide pretty printing</li>
</ul>
<p>Additionally all functions have arguments in data-formula order, making it simple to pipe into them via <code>%&gt;%</code>.</p>
<p>Contributions and feedback are welcome on <a href="https://github.com/leeper/cregg/issues">GitHub</a>.</p>
<div id="code-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#code-examples" class="anchor"></a>Code Examples</h2>
<p>The package includes an example conjoint dataset (borrowed and lightly modified from the <a href="https://cran.r-project.org/package=cjoint">cjoint</a> package), which is used here and and in examples:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"cregg"</span>)
<span class="kw">data</span>(<span class="st">"hainmueller"</span>)</code></pre></div>
<p>The package provides straightforward calculation and visualization of descriptive marginal means (MMs). These represent the mean outcome across all appearances of a particular conjoint feature level, averaging across all other features. In forced choice conjoint designs, MMs by definition average 0.5 with values above 0.5 indicating features that increase profile favorability and values below 0.5 indicating features that decrease profile favorability. For continuous outcomes, AMMs can take any value in the full range of the outcome. Calculation of MMs entail no modelling assumptions are simply descriptive quantities of interest:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># descriptive plotting</span>
f1 &lt;-<span class="st"> </span>ChosenImmigrant <span class="op">~</span><span class="st"> </span>Gender <span class="op">+</span><span class="st"> </span>Education <span class="op">+</span><span class="st"> </span>LanguageSkills <span class="op">+</span><span class="st"> </span>CountryOfOrigin <span class="op">+</span><span class="st"> </span>Job <span class="op">+</span><span class="st"> </span>JobExperience <span class="op">+</span><span class="st"> </span>JobPlans <span class="op">+</span><span class="st"> </span>ReasonForApplication <span class="op">+</span><span class="st"> </span>
<span class="st">    </span>PriorEntry
<span class="kw">plot</span>(<span class="kw"><a href="reference/mm.html">mm</a></span>(hainmueller, f1, <span class="dt">id =</span> <span class="op">~</span>CaseID), <span class="dt">vline =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="index_files/figure-html/mmplot-1.png" width="960"></p>
<p>cregg functions uses <code>attr(data$feature, "label")</code> to provide pretty printing of feature labels, so that varible names can be arbitrary. These can be overwritten using the <code>feature_labels</code> argument to override these settings. Feature levels are always deduced from the <code>levels()</code> of righthand-side variables in the model specification. All variables should be factors with levels in desired display order. Similarly, the plotted order of features is given by the order of terms in the RHS formula unless overridden by the order of variable names given in <code>feature_order</code>.</p>
<p>A more common analytic approach for conjoints is to estimate average marginal component effects (AMCEs) using some form of regression analysis. cregg uses <code>glm()</code> and <code>svyglm()</code> to perform estimation and <a href="https://cran.r-project.org/package=margins">margins</a> to generate average marginal effect estimates. Designs can be specified with any interactions between conjoint features but only AMCEs are returned. (No functionality is provided at the moment for explict estimation of feature interaction effects.) Just like for <code>amm()</code>, the output of <code><a href="reference/cregg.html">cj()</a></code> (or its alias, <code><a href="reference/amce.html">amce()</a></code>) is a tidy data frame:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># estimation</span>
amces &lt;-<span class="st"> </span><span class="kw"><a href="reference/cregg.html">cj</a></span>(hainmueller, f1, <span class="dt">id =</span> <span class="op">~</span>CaseID)
<span class="kw">head</span>(amces[<span class="kw">c</span>(<span class="st">"feature"</span>, <span class="st">"level"</span>, <span class="st">"estimate"</span>, <span class="st">"std.error"</span>)], 20L)</code></pre></div>
<pre><code>                  feature                    level     estimate   std.error
1                  Gender                   Female  0.000000000          NA
2                  Gender                     Male -0.024978435 0.007983009
3  Educational Attainment                No Formal  0.000000000          NA
4  Educational Attainment                4th Grade  0.033367996 0.014971357
5  Educational Attainment                8th Grade  0.057600734 0.015021063
6  Educational Attainment              High School  0.119492095 0.015118761
7  Educational Attainment         Two-Year College  0.154588453 0.015840268
8  Educational Attainment           College Degree  0.180948898 0.016183493
9  Educational Attainment          Graduate Degree  0.169440741 0.015809304
10        Language Skills           Fluent English  0.000000000          NA
11        Language Skills           Broken English -0.056822717 0.011265303
12        Language Skills Tried English but Unable -0.127357585 0.011321142
13        Language Skills         Used Interpreter -0.159808492 0.011553933
14      Country of Origin                    India  0.000000000          NA
15      Country of Origin                  Germany  0.047646243 0.016667948
16      Country of Origin                   France  0.026564521 0.017327948
17      Country of Origin                   Mexico  0.009818758 0.017530373
18      Country of Origin              Philippines  0.034102011 0.017412416
19      Country of Origin                   Poland  0.032666819 0.017640451
20      Country of Origin                    China -0.020128816 0.017843819</code></pre>
<p>This makes it very easy to modify, combine, print, etc. the resulting output. It also makes it easy to visualize using ggplot2. A convenience visualization function is provided:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plotting of AMCEs</span>
<span class="kw">plot</span>(amces)</code></pre></div>
<p><img src="index_files/figure-html/plot_amce-1.png" width="960"></p>
<p>The package also provide a useful function for checking display frequencies of conjoint features (to ensure equal - or unequal - display frequency):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plotting of display frequencies</span>
<span class="kw">plot</span>(<span class="kw"><a href="reference/freqs.html">freqs</a></span>(hainmueller, f1, <span class="dt">id =</span> <span class="op">~</span>CaseID))</code></pre></div>
<p><img src="index_files/figure-html/plot_freqs-1.png" width="960"></p>
<p>As can be clear in the above, constraints were imposed in the original study on the allowed combinations of <code>Job</code> and <code>Education</code> and also on combinations of <code>CountryOfOrigin</code> and <code>ReasonForApplication</code>. The <code><a href="reference/freqs.html">props()</a></code> function provides tidy proportions tables to quickly</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">subset</span>(<span class="kw"><a href="reference/freqs.html">props</a></span>(hainmueller, <span class="op">~</span>Job <span class="op">+</span><span class="st"> </span>Education, <span class="dt">id =</span> <span class="op">~</span>CaseID), Proportion <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</code></pre></div>
<pre><code>                   Job   Education Proportion
5    Financial Analyst   No Formal          0
8  Computer Programmer   No Formal          0
10  Research Scientist   No Formal          0
11              Doctor   No Formal          0
16   Financial Analyst   4th Grade          0
19 Computer Programmer   4th Grade          0
21  Research Scientist   4th Grade          0
22              Doctor   4th Grade          0
27   Financial Analyst   8th Grade          0
30 Computer Programmer   8th Grade          0
32  Research Scientist   8th Grade          0
33              Doctor   8th Grade          0
38   Financial Analyst High School          0
41 Computer Programmer High School          0
43  Research Scientist High School          0
44              Doctor High School          0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">subset</span>(<span class="kw"><a href="reference/freqs.html">props</a></span>(hainmueller, <span class="op">~</span>CountryOfOrigin <span class="op">+</span><span class="st"> </span>ReasonForApplication, <span class="dt">id =</span> <span class="op">~</span>CaseID), Proportion <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</code></pre></div>
<pre><code>   CountryOfOrigin ReasonForApplication Proportion
21           India   Escape Persecution          0
22         Germany   Escape Persecution          0
23          France   Escape Persecution          0
24          Mexico   Escape Persecution          0
25     Philippines   Escape Persecution          0
26          Poland   Escape Persecution          0</code></pre>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p><a href="https://cran.r-project.org/package=cregg"><img src="https://www.r-pkg.org/badges/version/cregg" alt="CRAN"></a> <img src="https://cranlogs.r-pkg.org/badges/cregg" alt="Downloads"><a href="https://travis-ci.org/leeper/cregg"><img src="https://travis-ci.org/leeper/cregg.png?branch=master" alt="Travis Build Status"></a> <a href="https://ci.appveyor.com/project/leeper/cregg"><img src="https://ci.appveyor.com/api/projects/status/PROJECTNUMBER?svg=true" alt="Appveyor Build Status"></a> <a href="https://codecov.io/github/leeper/cregg?branch=master"><img src="https://codecov.io/github/leeper/cregg/coverage.svg?branch=master" alt="codecov.io"></a></p>
<p>This package is not yet on CRAN. To install the latest development version you can pull a potentially unstable version directly from GitHub:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">"ghit"</span>)) {
    <span class="kw">install.packages</span>(<span class="st">"ghit"</span>)
}
ghit<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ghit/topics/install_github">install_github</a></span>(<span class="st">"leeper/cregg"</span>)</code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/leeper/cregg">https://​github.com/​leeper/​cregg</a>
</li>
<li>Report a bug at <br><a href="https://github.com/leeper/cregg/issues">https://​github.com/​leeper/​cregg/​issues</a>
</li>
</ul>
<h2>License</h2>
<p><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></p>
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing cregg</a></li>
</ul>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Thomas J. Leeper <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-4097-6326" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid"></a> </li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Thomas J. Leeper.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
